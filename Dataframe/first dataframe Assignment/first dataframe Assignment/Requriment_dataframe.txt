DataAnylatic project :=>

a.) Create a dataframe with Total Aadhaar's generated for each state

Ans - 

var df = spark.read.format("csv").option("header","true").option("inferSchema","true").load("C://Users//xx//Desktop//project//Dataframe//first dataframe Assignment//first dataframe Assignment//UIDAI-ENR-DETAIL-20170308.csv")
var df2 = df.groupBy("State").agg(sum("Aadhaar generated"))
df2.show()                                              


b.) Create a dataframe with Total Aadhaar's generated by each enrollment agency

var df = spark.read.format("csv").option("header","true").option("inferSchema","true").load("C://Users//xx//Desktop//project//Dataframe//first dataframe Assignment//first dataframe Assignment//UIDAI-ENR-DETAIL-20170308.csv")
var df2 = df.groupBy("Enrolment Agency").agg(sum("Aadhaar generated"))
df2.show()


c.) Create dataframe with top 10 districts with maximum Aadhaar's generated for both Male and Female?

var df = spark.read.format("csv").option("header","true").option("inferSchema","true").load("C://Users//xx//Desktop//project//Dataframe//first dataframe Assignment//first dataframe Assignment//UIDAI-ENR-DETAIL-20170308.csv")
var df1 = df.filter(df("Gender") === "M" || df("Gender") === "F")
var df2 = df1.groupBy("District").agg(sum("Aadhaar generated"))
var df3 = df2.orderBy(desc("count")).head(10)

or

df.filter(df("Gender") === "M" || df("Gender") === "F").groupBy("District").count().orderBy(desc("count")).head(10)


d.) Create a dataframe with Total Aadhaar's generated for top 10 least state

var df = spark.read.format("csv").option("header","true").option("inferSchema","true").load("C://Users//xx//Desktop//project//Dataframe//first dataframe Assignment//first dataframe Assignment//UIDAI-ENR-DETAIL-20170308.csv")
var df2 = df.groupBy("state").agg(sum("Aadhaar generated")).tail(10)


e.) for which age most adhar card has declined ?

var df = spark.read.format("csv").option("header","true").option("inferSchema","true").load("C://Users//xx//Desktop//project//Dataframe//first dataframe Assignment//first dataframe Assignment//UIDAI-ENR-DETAIL-20170308.csv")
var df1 = df.filter(df("Aadhaar generated") === "0").groupBy("Age").count().orderBy(desc("count")).head(1)
df1.orderBy(desc("count")).head(1)